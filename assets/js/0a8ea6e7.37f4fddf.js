"use strict";(globalThis.webpackChunkphysical_ai_humanoid_robotics_book=globalThis.webpackChunkphysical_ai_humanoid_robotics_book||[]).push([[514],{8453:(e,n,r)=>{r.d(n,{R:()=>s,x:()=>t});var o=r(6540);const i={},l=o.createContext(i);function s(e){const n=o.useContext(l);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),o.createElement(l.Provider,{value:n},e.children)}},9541:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>p,frontMatter:()=>s,metadata:()=>o,toc:()=>a});const o=JSON.parse('{"id":"rclpy-example-controllers","title":"rclpy Example Controllers","description":"Implementing robotic control using rclpy.","source":"@site/docs/rclpy-example-controllers.md","sourceDirName":".","slug":"/rclpy-example-controllers","permalink":"/physical-ai-humanoid-robotics-book/docs/rclpy-example-controllers","draft":false,"unlisted":false,"editUrl":"https://github.com/abdusubhan11/physical-ai-humanoid-robotics-book/tree/main/frontend/docs/rclpy-example-controllers.md","tags":[],"version":"current","frontMatter":{"title":"rclpy Example Controllers","description":"Implementing robotic control using rclpy.","slug":"rclpy-example-controllers"},"sidebar":"tutorialSidebar","previous":{"title":"Module 4 \u2014 Vision-Language-Action","permalink":"/physical-ai-humanoid-robotics-book/docs/module4_vision_language_action"},"next":{"title":"ROS 2 Nodes","permalink":"/physical-ai-humanoid-robotics-book/docs/ros2-nodes"}}');var i=r(4848),l=r(8453);const s={title:"rclpy Example Controllers",description:"Implementing robotic control using rclpy.",slug:"rclpy-example-controllers"},t="rclpy Example Controllers: Bringing Robots to Life with Python",c={},a=[{value:"Setting Up Your Python Environment for <code>rclpy</code>",id:"setting-up-your-python-environment-for-rclpy",level:2},{value:"Basic Controller Structure in <code>rclpy</code>",id:"basic-controller-structure-in-rclpy",level:2},{value:"Example: A Simple Differential Drive Robot Controller",id:"example-a-simple-differential-drive-robot-controller",level:2},{value:"1. <code>teleop_publisher.py</code> (Simulated Joystick/Command Publisher)",id:"1-teleop_publisherpy-simulated-joystickcommand-publisher",level:3}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"rclpy-example-controllers-bringing-robots-to-life-with-python",children:"rclpy Example Controllers: Bringing Robots to Life with Python"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"rclpy"})," is the Python client library for ROS 2, providing a convenient and powerful way to develop ROS 2 applications using the Python programming language. It allows developers to create nodes, publish to topics, subscribe to topics, call services, and implement service servers, among other functionalities. This chapter will explore how to use ",(0,i.jsx)(n.code,{children:"rclpy"})," to build basic robotic controllers, focusing on practical examples that demonstrate fundamental ROS 2 concepts."]}),"\n",(0,i.jsxs)(n.h2,{id:"setting-up-your-python-environment-for-rclpy",children:["Setting Up Your Python Environment for ",(0,i.jsx)(n.code,{children:"rclpy"})]}),"\n",(0,i.jsx)(n.p,{children:"Before diving into controller development, ensure your environment is correctly set up:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"ROS 2 Installation:"})," Make sure you have a working ROS 2 installation (e.g., Foxy, Galactic, Humble, Iron)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Python 3:"})," ",(0,i.jsx)(n.code,{children:"rclpy"})," requires Python 3."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"ROS 2 Python Packages:"})," Ensure the necessary ROS 2 Python packages are installed, typically handled during the main ROS 2 installation. You might need to source your ROS 2 environment."]}),"\n"]}),"\n",(0,i.jsxs)(n.h2,{id:"basic-controller-structure-in-rclpy",children:["Basic Controller Structure in ",(0,i.jsx)(n.code,{children:"rclpy"})]}),"\n",(0,i.jsxs)(n.p,{children:["A typical ",(0,i.jsx)(n.code,{children:"rclpy"})," node that functions as a controller will generally involve:"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsxs)(n.strong,{children:["Import ",(0,i.jsx)(n.code,{children:"rclpy"}),":"]})," Start by importing the ",(0,i.jsx)(n.code,{children:"rclpy"})," library."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Create a Node:"})," Instantiate a new ",(0,i.jsx)(n.code,{children:"Node"})," object."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Create Publishers/Subscribers:"})," Set up communication channels. For a controller, this often means subscribing to sensor data (e.g., odometry) and publishing control commands (e.g., ",(0,i.jsx)(n.code,{children:"Twist"})," messages for velocity control)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Callback Functions:"})," Define functions that are executed when new messages arrive on subscribed topics."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Spinning the Node:"})," Use ",(0,i.jsx)(n.code,{children:"rclpy.spin()"})," to keep the node alive and process callbacks."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"example-a-simple-differential-drive-robot-controller",children:"Example: A Simple Differential Drive Robot Controller"}),"\n",(0,i.jsxs)(n.p,{children:["Let's consider a common scenario: controlling a differential drive robot. This type of robot typically receives velocity commands (linear and angular) and publishes its odometry (position and orientation). A simple controller might subscribe to joystick commands and publish corresponding ",(0,i.jsx)(n.code,{children:"Twist"})," messages."]}),"\n",(0,i.jsxs)(n.h3,{id:"1-teleop_publisherpy-simulated-joystickcommand-publisher",children:["1. ",(0,i.jsx)(n.code,{children:"teleop_publisher.py"})," (Simulated Joystick/Command Publisher)"]}),"\n",(0,i.jsxs)(n.p,{children:["This node will simulate user input, publishing ",(0,i.jsx)(n.code,{children:"Twist"})," messages to ",(0,i.jsx)(n.code,{children:"/cmd_vel"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom geometry_msgs.msg import Twist\nimport time\n\nclass TeleopPublisher(Node):\n\n    def __init__(self):\n        super().__init__('teleop_publisher')\n        self.publisher_ = self.create_publisher(Twist, 'cmd_vel', 10)\n        self.timer = self.create_timer(0.5, self.publish_cmd_vel)  # Publish every 0.5 seconds\n        self.get_logger().info('Teleop Publisher Node started')\n\n        self.linear_speed = 0.5  # m/s\n        self.angular_speed = 0.5  # rad/s\n        self.direction = 0  # 0: forward, 1: turn left, 2: turn right, 3: backward\n\n    def publish_cmd_vel(self):\n        twist_msg = Twist()\n\n        if self.direction == 0:\n            twist_msg.linear.x = self.linear_speed\n            twist_msg.angular.z = 0.0\n            self.get_logger().info('Moving forward')\n        elif self.direction == 1:\n            twist_msg.linear.x = 0.0\n            twist_msg.angular.z = self.angular_speed\n            self.get_logger().info('Turning left')\n        elif self.direction == 2:\n            twist_msg.linear.x = 0.0\n            twist_msg.angular.z = -self.angular_speed\n            self.get_logger().info('Turning right')\n        elif self.direction == 3:\n            twist_msg.linear.x = -self.linear_speed\n            twist_msg.angular.z = 0.0\n            self.get_logger().info('Moving backward')\n\n        self.publisher_.publish(twist_msg)\n\n        # Cycle through directions for demonstration\n        self.direction = (self.direction + 1) % 4\n\ndef main(args=None):\n    rclpy.init(args=args)\n    teleop_publisher = TeleopPublisher()\n    try:\n        rclpy.spin(teleop_publisher)\n    except KeyboardInterrupt:\n        pass\n    teleop_publisher.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})})]})}function p(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);